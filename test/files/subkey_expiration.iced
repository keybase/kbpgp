{KeyManager} = require '../..'

key = """
-----BEGIN PGP PUBLIC KEY BLOCK-----
Version: GnuPG v1

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
=Dd5a
-----END PGP PUBLIC KEY BLOCK-----
"""

exports.key_1 = (T,cb) ->
  now = 1439515152
  await KeyManager.import_from_armored_pgp { armored : key, opts : { now } }, defer err, km, warnings
  T.no_error err
  w = warnings.warnings()
  T.equal w.length, 2, "only 2 warnings"
  T.equal w[0], 'Signature failure in packet 3: Key expired 6225552s ago (e4f3bede5fd00974)', "fail 0"
  T.equal w[1], 'Subkey 0 was invalid; discarding', "fail 1"
  cb()
